<#INCLUDE filename="include_header.html">
<#INCLUDE filename="include_menu.html">
    <div id="content-wrap" class="col-sm-8 col-md-9">
      <div id="content">
         <form action="illiad.dll" method="post" name="LoanRequest" class="form-horizontal">
                <input type="hidden" name="ILLiadForm" value="LoanRequest">
                <input type="hidden" name="Username" value="<#PARAM name="Username">">
                <input type="hidden" name="SessionID" value="<#PARAM name="SessionID">">
                	<h2>Book Request</h2>
					<#STATUS><br />
					<div>All fields with <span class="req">*</span> must be filled</div>
          <h3>Describe the item you want</h3>
	
					<div class="form-group">
            <label for="ISSN" class="col-sm-4 control-label"><span class="<#ERROR name="ERRORISSN">"><b>ISBN or OCLC Number</b></span></label>
            <input class="col-sm-6" id="ISSN" class="form-control" name="ISSN" type="text" tabindex="4" value="<#PARAM name="ISSN">">
            <div class="col-sm-2"><button type="button" class="btn" id="isbn-lookup">Get Info</button><span style="display:none;margin-left:5px;" class="fa fa-spinner fa-spin"></span></div>
            <div class="col-sm-8 col-sm-offset-2"><strong>If used, some book information will be automatically added</strong></div>
            <div class="col-sm-4 col-sm-offset-3 text-center" id="lookup-info"></div>
          </div>
          
          <hr/>
          
          <div class="form-group">
            <label for="LoanTitle" class="col-sm-4 control-label"><span class="<#ERROR name="ERRORLoanTitle">"><span class="req">*</span><b>Title</b></span></label>
            <textarea class="col-sm-8" id="LoanTitle" name="LoanTitle" rows="2" cols="40" class="f-name" tabindex="2" required><#PARAM name="LoanTitle"></textarea>
          </div>
          
          <div class="form-group">
            <label for="LoanAuthor" class="col-sm-4 control-label"><span class="<#ERROR name="ERRORLoanAuthor">"><b>Author/Editors</b></span></label>
            <input class="col-sm-8" id="LoanAuthor" name="LoanAuthor" type="text" class="f-name" tabindex="2" value='<#PARAM name="LoanAuthor">'/>
          </div>
          
          <div class="form-group">
            <label for="LoanPublisher" class="col-sm-4 control-label"><span class="<#ERROR name="ERRORLoanPublisher">"><b>Publisher</b></span></label>
            <input class="col-sm-8" id="LoanPublisher" name="LoanPublisher" type="text" class="f-name" tabindex="2" value='<#PARAM name="LoanPublisher">'/>
          </div>
          
          <div class="form-group">
            <label for="LoanPlace" class="col-sm-4 control-label"><span class="<#ERROR name="ERRORLoanPlace">"><b>Place of Publication</b></span></label>
            <input class="col-sm-8" id="LoanPlace" name="LoanPlace" type="text" class="f-name" tabindex="2" value='<#PARAM name="LoanPlace">'/>
          </div>
          
          <div class="form-group">
            <label for="LoanDate" class="col-sm-4 control-label"><span class="<#ERROR name="ERRORLoanDate">"><b>Date</b></span></label>
            <input class="col-sm-8" id="LoanDate" name="LoanDate" type="text" class="f-name" tabindex="2" value='<#PARAM name="LoanDate">'/>
          </div>
          
          <div class="form-group">
            <label for="LoanEdition" class="col-sm-4 control-label"><span class="<#ERROR name="ERRORLoanEdition">"><b>Edition</b></span></label>
            <input class="col-sm-8" id="LoanEdition" name="LoanEdition" type="text" class="f-name" tabindex="2" value='<#PARAM name="LoanEdition">'/>
          </div>

          <div class="form-group">
              <label for="NotWantedAfter" class="col-sm-4 text-right"><span class="<#ERROR name="ERRORNotWantedAfter">"><span class="req">*</span><b>Not Wanted After Date</b></span></label>
              <input class="col-sm-8" id="NotWantedAfter" class="form-control" name="NotWantedAfter" type="text" tabindex="4" required value="<#PARAM name="NotWantedAfter">">
          </div>
          
          <hr/>
          
          <div class="form-group">
              <label for="AcceptNonEnglish" class="col-sm-4 text-right"><span class="<#ERROR name="ERRORAcceptNonEnglish">"><b>Language Other Than English?</b></span>
              <br/>
              <span>Specify acceptable languages in the notes field.</span>
              </label>
              <select id="AcceptNonEnglish" name="AcceptNonEnglish" size="1" class="f-name" tabindex="12">
                <option selected><#PARAM name="AcceptNonEnglish"></option>
                <option>No</option>
                <option>Yes</option>
              </select>
          </div>
          
          <div class="form-group">
              <label for="AcceptAlternateEdition" class="col-sm-4 text-right"><span class="<#ERROR name="ERRORAcceptAlternateEdition">"><b>Will you accept an alternate edition of this item?</b></span>
              </label>
              <select id="AcceptAlternateEdition" name="AcceptAlternateEdition" size="1" class="f-name" tabindex="12">
                <option selected><#PARAM name="AcceptAlternateEdition"></option>
                <option>No</option>
                <option>Yes</option>
              </select>
          </div>
          
          <hr/>

					<div class="form-group">
            <label for="Notes" class="col-sm-12"><span class="<#ERROR name="ERRORNotes">"><b>Notes</b></span>
            <br/>
            <span>Put any information here that may help us find the item, as well as any other pertinent information.</span>
            </label>
            <textarea class="col-sm-12 id="Notes" name="Notes" rows="2" cols="40" class="f-name" tabindex="13"><#PARAM name="Notes"></textarea>
          </div>
            
          <div class="form-group">
            <label for="CitedIn" class="col-sm-12"><span class="<#ERROR name="ERRORCitedIn">"><b>Where did you find this item cited?</b></span>
            <br/>
            <span>Examples are Academic OneFile&reg;, CINAHL&reg;, PsycINFO&reg;, or a specific journal or book.</span>
            </label>
            <textarea class="col-sm-12" id="CitedIn" name="CitedIn" rows="2" cols="40" class="f-name" tabindex="13"><#PARAM name="CitedIn"></textarea>
          </div>

          <center>
            <input type="submit" name="SubmitButton" value="Submit Request" class="btn" tabindex="60">
          </center>
        </form>
      </div>
    </div>
    
      <script>
      $(document).ready(function() {
        $('#isbn-lookup').click(function(e) {
          ga('send', 'event', 'lookup', 'click', 'Book-lookup');
          $('#lookup-info').hide();
          var $button = $(e.currentTarget);
          var number = $('#ISSN').val().replace(/-/g,'').trim();
          $('#ISSN').val(number);
          if (number === '') {
            return false;
          }
          $button.next('span').show();
          var query = 'isbn:';
          if (number.length !== 10 && number.length !== 13) {
            query = 'oclc:';
            $('#ISSN').attr('name', 'ESPNumber');
          } else {
            $('#ISSN').attr('name', 'ISSN');
          }
          query += number;
          try {
          $.ajax({
            url: 'https://www.googleapis.com/books/v1/volumes',
            data: {
              maxResults: '1',
              printType: 'books',
              q: query
            },
            success: function(data) {
              $button.next('span').hide();
              if (data.totalItems === 0) {
                $('#lookup-info').text('Could not find book information').addClass('alert alert-info').show();
                return;
              }
              var info = data.items[0].volumeInfo;
              $('#LoanTitle').val(info.title);
              $('#LoanAuthor').val(info.authors.join('; '));
              $('#LoanPublisher').val(info.publisher);
              $('#LoanDate').val(info.publishedDate);
            },
            error: function() {
              $button.next('span').hide();
              $('#lookup-info').text('Could not find book information').addClass('alert alert-info').show();
            }
          });
          } catch (e) {
            $button.next('span').hide();
            $('#lookup-info').text('Could not find book information').addClass('alert alert-info').show();
          }
        });
        
        $('#NotWantedAfter').datepicker();
      });
    </script>
<#INCLUDE filename="include_footer.html">
